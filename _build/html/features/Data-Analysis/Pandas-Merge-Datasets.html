

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Pandas — Merge Datasets &#8212; Introduction to Cultural Analytics &amp; Python</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/custom.js"></script>
    <script src="../../_static/ansi_up.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://melaniewalsh.github.io/Intro-Cultural-Analytics/features/Data-Analysis/Pandas-Merge-Datasets.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Data Collection" href="../Data-Collection/Data-Collection.html" />
    <link rel="prev" title="Pandas Basics (Part 3)" href="Pandas-Basics-Part3.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://melaniewalsh.github.io/Intro-Cultural-Analytics/features/Data-Analysis/Pandas-Merge-Datasets.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Pandas — Merge Datasets" />
<meta property="og:description" content="Pandas — Merge Datasets  In this lesson, we’re going to demonstrate how to merge two datasets with Pandas. We’re going to walk through a real-world example of h" />
<meta property="og:image"       content="https://melaniewalsh.github.io/Intro-Cultural-Analytics/_static/favicon.ico" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/favicon.ico" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Introduction to Cultural Analytics & Python</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  How To
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../How-To-Interact-With-This-Book.html">
   Interact With This Book
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  The Course
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../course-schedule.html">
   Course Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Course Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Homework/HW-Description-Without-Links.html">
   Homework Assignments
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  The Book
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Command-Line/The-Command-Line.html">
   The Command Line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Python/Python.html">
   Programming in Python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="Data-Analysis.html">
   Data Analysis (Pandas)
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Pandas-Basics-Part1.html">
     Pandas Basics (Part 1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Pandas-Basics-Part2.html">
     Pandas Basics (Part 2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Pandas-Basics-Part3.html">
     Pandas Basics (Part 3)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Pandas — Merge Datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data-Collection/Data-Collection.html">
   Data Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data-Collection/Data-Collection.html#learn-how-to-collect">
   Learn How to Collect
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Text-Analysis/Text-Analysis.html">
   Text Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Network-Analysis/Network-Analysis-Home.html">
   Network Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Mapping/Mapping-Home.html">
   Mapping
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Datasets/Datasets.html">
   Datasets
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extra Materials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Python/Jupyter-Tips-Tricks.html">
   Jupyter Tips &amp; Tricks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Python/Randomize-Students.html">
   Make Random Student Groups
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/features/Data-Analysis/Pandas-Merge-Datasets.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/melaniewalsh/Intro-Cultural-Analytics/issues/new?title=Issue%20on%20page%20%2Ffeatures/Data-Analysis/Pandas-Merge-Datasets.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/melaniewalsh/Intro-Cultural-Analytics/master?urlpath=lab/tree/features/Data-Analysis/Pandas-Merge-Datasets.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset">
   Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-pudding-s-film-dialogue-data">
     <em>
      The Pudding
     </em>
     ’s Film Dialogue Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-datasets">
   Merge Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-dialogue-proportions">
   Calculate Dialogue Proportions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#write-to-csv-file">
   Write to CSV File
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pandas-merge-datasets">
<h1>Pandas — Merge Datasets<a class="headerlink" href="#pandas-merge-datasets" title="Permalink to this headline">¶</a></h1>
<p>In this lesson, we’re going to demonstrate how to merge two datasets with Pandas. We’re going to walk through a real-world example of how I merged two different datasets published by <em>The Pudding</em> to create the CSV file that we used in the previous lesson.</p>
<hr class="docutils" />
<div class="section" id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-pudding-s-film-dialogue-data">
<h3><em>The Pudding</em>’s Film Dialogue Data<a class="headerlink" href="#the-pudding-s-film-dialogue-data" title="Permalink to this headline">¶</a></h3>
<p>When Hannah Andersen and Matt Daniels <a class="reference external" href="https://github.com/matthewfdaniels/scripts/">published</a> the data behind their <a class="reference external" href="https://pudding.cool/2017/03/film-dialogue/"><em>Pudding</em> essay</a> about film dialogue, they published this data as a few different CSV files. But I wanted to combine them into a single CSV file.</p>
<hr class="docutils" />
<p><strong>Import Pandas</strong></p>
<p>To use the Pandas library, we first need to <code class="docutils literal notranslate"><span class="pre">import</span></code> it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>The above <code class="docutils literal notranslate"><span class="pre">import</span></code> statement not only imports the Pandas library but also gives it an alias or nickname — <code class="docutils literal notranslate"><span class="pre">pd</span></code>. This alias will save us from having to type out the entire words <code class="docutils literal notranslate"><span class="pre">pandas</span></code> each time we need to use it. Many Python libraries have commonly used aliases like <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<p><strong>Set Display Settings</strong></p>
<p>By default, Pandas will display 60 rows and 20 columns. I often change <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html">Pandas’ default display settings</a> to show more rows or columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Read in CSV File</strong></p>
<p>To read in a CSV file, we will use the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> and insert the name of our desired file path.</p>
<p>Hannah Andersen and Matt Daniels published one CSV file called “meta_data7.csv” that contains, among things, the title of each movie, the year of its release, and its box office gross.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Pudding/meta_data7.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>script_id</th>
      <th>imdb_id</th>
      <th>title</th>
      <th>year</th>
      <th>gross</th>
      <th>lines_data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1534</td>
      <td>tt1022603</td>
      <td>(500) Days of Summer</td>
      <td>2009</td>
      <td>37.0</td>
      <td>7435445256774780000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1512</td>
      <td>tt0147800</td>
      <td>10 Things I Hate About You</td>
      <td>1999</td>
      <td>65.0</td>
      <td>1777752320274530000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1514</td>
      <td>tt0417385</td>
      <td>12 and Holding</td>
      <td>2005</td>
      <td>NaN</td>
      <td>5461357777754220000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1517</td>
      <td>tt2024544</td>
      <td>12 Years a Slave</td>
      <td>2013</td>
      <td>60.0</td>
      <td>4567334777777780000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1520</td>
      <td>tt1542344</td>
      <td>127 Hours</td>
      <td>2010</td>
      <td>20.0</td>
      <td>453513352345766000000000000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>3765</td>
      <td>tt0403702</td>
      <td>Youth in Revolt</td>
      <td>2009</td>
      <td>17.0</td>
      <td>7766777656545340000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>3766</td>
      <td>tt1790885</td>
      <td>Zero Dark Thirty</td>
      <td>2012</td>
      <td>104.0</td>
      <td>5677677556654470000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>8158</td>
      <td>tt0120906</td>
      <td>Zero Effect</td>
      <td>1998</td>
      <td>3.0</td>
      <td>4777774477777650000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>3768</td>
      <td>tt0421090</td>
      <td>Zerophilia</td>
      <td>2005</td>
      <td>NaN</td>
      <td>7647774446763350000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>6491</td>
      <td>tt0443706</td>
      <td>Zodiac</td>
      <td>2007</td>
      <td>41.0</td>
      <td>2447767766763570000000000000000000000000000000...</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 6 columns</p>
</div></div></div>
</div>
<p>We’re going to drop the column “lines_data”, which contains information about when during the film each character speaks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;lines_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>They published another CSV file called “character_list5.csv” that contains, among other things, the name, gender, and age of each character as well as the number of words the character speaks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">characters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Pudding/character_list5.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">characters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>script_id</th>
      <th>imdb_character_name</th>
      <th>words</th>
      <th>gender</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>280</td>
      <td>betty</td>
      <td>311</td>
      <td>f</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>280</td>
      <td>carolyn johnson</td>
      <td>873</td>
      <td>f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>280</td>
      <td>eleanor</td>
      <td>138</td>
      <td>f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>280</td>
      <td>francesca johns</td>
      <td>2251</td>
      <td>f</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>280</td>
      <td>madge</td>
      <td>190</td>
      <td>f</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23043</th>
      <td>9254</td>
      <td>lumiere</td>
      <td>1063</td>
      <td>m</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>23044</th>
      <td>9254</td>
      <td>maurice</td>
      <td>1107</td>
      <td>m</td>
      <td>71.0</td>
    </tr>
    <tr>
      <th>23045</th>
      <td>9254</td>
      <td>monsieur d'arqu</td>
      <td>114</td>
      <td>m</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>23046</th>
      <td>9254</td>
      <td>mrs. potts</td>
      <td>564</td>
      <td>f</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>23047</th>
      <td>9254</td>
      <td>wardrobe</td>
      <td>121</td>
      <td>f</td>
      <td>54.0</td>
    </tr>
  </tbody>
</table>
<p>23048 rows × 5 columns</p>
</div></div></div>
</div>
<p>As you can see, the characters DataFrame doesn’t include the actual title of the movie in which the character appears or the movie’s release year or box office gross. And the metadata datafram doesn’t contain any information about the characters. We want that info all in one place. So how can we combine all of this data together?</p>
</div>
</div>
<div class="section" id="merge-datasets">
<h2>Merge Datasets<a class="headerlink" href="#merge-datasets" title="Permalink to this headline">¶</a></h2>
<p>If you look closely, there’s one column that both datasets share in common: “script_id”. If two datasets share at least one column in common, we can merge them together based on this column.</p>
<p>We can use the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html"><code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function</a> and type in the name of the first dataframe, the name of the second dataframe, and the shared column to be merged on.</p>
<div class="cell tag_full-width tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">characters</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;script_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>script_id</th>
      <th>imdb_character_name</th>
      <th>words</th>
      <th>gender</th>
      <th>age</th>
      <th>imdb_id</th>
      <th>title</th>
      <th>year</th>
      <th>gross</th>
      <th>lines_data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>280</td>
      <td>betty</td>
      <td>311</td>
      <td>f</td>
      <td>35.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>4332023434343450000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>280</td>
      <td>carolyn johnson</td>
      <td>873</td>
      <td>f</td>
      <td>NaN</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>4332023434343450000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>280</td>
      <td>eleanor</td>
      <td>138</td>
      <td>f</td>
      <td>NaN</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>4332023434343450000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>280</td>
      <td>francesca johns</td>
      <td>2251</td>
      <td>f</td>
      <td>46.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>4332023434343450000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>280</td>
      <td>madge</td>
      <td>190</td>
      <td>f</td>
      <td>46.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>4332023434343450000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23043</th>
      <td>9254</td>
      <td>lumiere</td>
      <td>1063</td>
      <td>m</td>
      <td>56.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>3245753334377770000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>23044</th>
      <td>9254</td>
      <td>maurice</td>
      <td>1107</td>
      <td>m</td>
      <td>71.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>3245753334377770000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>23045</th>
      <td>9254</td>
      <td>monsieur d'arqu</td>
      <td>114</td>
      <td>m</td>
      <td>58.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>3245753334377770000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>23046</th>
      <td>9254</td>
      <td>mrs. potts</td>
      <td>564</td>
      <td>f</td>
      <td>66.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>3245753334377770000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>23047</th>
      <td>9254</td>
      <td>wardrobe</td>
      <td>121</td>
      <td>f</td>
      <td>54.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>3245753334377770000000000000000000000000000000...</td>
    </tr>
  </tbody>
</table>
<p>23048 rows × 10 columns</p>
</div></div></div>
</div>
<p>Now we have a combined DataFrame with character and film information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">characters</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;script_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-dialogue-proportions">
<h2>Calculate Dialogue Proportions<a class="headerlink" href="#calculate-dialogue-proportions" title="Permalink to this headline">¶</a></h2>
<p>We’re going to add one more column to this dataset before the next lesson. We’re going to calculate the proportion of words spoken in each film by each character. To do so, we’re going to <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> the movie’s title and calculate the sum total number of words spoken in each movie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)[[</span><span class="s1">&#39;words&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>words</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(500) Days of Summer</th>
      <td>18500</td>
    </tr>
    <tr>
      <th>10 Things I Hate About You</th>
      <td>19680</td>
    </tr>
    <tr>
      <th>12 Years a Slave</th>
      <td>19628</td>
    </tr>
    <tr>
      <th>12 and Holding</th>
      <td>15968</td>
    </tr>
    <tr>
      <th>127 Hours</th>
      <td>5145</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>Zero Effect</th>
      <td>13927</td>
    </tr>
    <tr>
      <th>Zerophilia</th>
      <td>16686</td>
    </tr>
    <tr>
      <th>Zodiac</th>
      <td>14656</td>
    </tr>
    <tr>
      <th>eXistenZ</th>
      <td>9447</td>
    </tr>
    <tr>
      <th>xXx</th>
      <td>8285</td>
    </tr>
  </tbody>
</table>
<p>1994 rows × 1 columns</p>
</div></div></div>
</div>
<p>If we use the <code class="docutils literal notranslate"><span class="pre">.transform()</span></code>, we can turn this groupby into a single column of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">])[[</span><span class="s1">&#39;words&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6394</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6394</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6394</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6394</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6394</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>23043</th>
      <td>10159</td>
    </tr>
    <tr>
      <th>23044</th>
      <td>10159</td>
    </tr>
    <tr>
      <th>23045</th>
      <td>10159</td>
    </tr>
    <tr>
      <th>23046</th>
      <td>10159</td>
    </tr>
    <tr>
      <th>23047</th>
      <td>10159</td>
    </tr>
  </tbody>
</table>
<p>23048 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total_movie_words</span> <span class="o">=</span> <span class="n">merged_movie_character</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">])[[</span><span class="s1">&#39;words&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we’re going to divide the total number of words spoken by each character by the total number of words spoken in each film.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total_character_words</span> <span class="o">=</span> <span class="n">merged_movie_character</span><span class="p">[[</span><span class="s1">&#39;words&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total_character_words</span> <span class="o">/</span> <span class="n">total_movie_words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.048639</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.136534</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.021583</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.352049</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.029715</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>23043</th>
      <td>0.104636</td>
    </tr>
    <tr>
      <th>23044</th>
      <td>0.108967</td>
    </tr>
    <tr>
      <th>23045</th>
      <td>0.011222</td>
    </tr>
    <tr>
      <th>23046</th>
      <td>0.055517</td>
    </tr>
    <tr>
      <th>23047</th>
      <td>0.011911</td>
    </tr>
  </tbody>
</table>
<p>23048 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dialogue_proportion</span> <span class="o">=</span> <span class="n">total_character_words</span> <span class="o">/</span> <span class="n">total_movie_words</span>
</pre></div>
</div>
</div>
</div>
<p>Then we’re going to add it as a new column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span><span class="p">[</span><span class="s1">&#39;proportion_of_dialogue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dialogue_proportion</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_full-width tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>script_id</th>
      <th>imdb_character_name</th>
      <th>words</th>
      <th>gender</th>
      <th>age</th>
      <th>imdb_id</th>
      <th>title</th>
      <th>year</th>
      <th>gross</th>
      <th>proportion_of_dialogue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>280</td>
      <td>betty</td>
      <td>311</td>
      <td>f</td>
      <td>35.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>0.048639</td>
    </tr>
    <tr>
      <th>1</th>
      <td>280</td>
      <td>carolyn johnson</td>
      <td>873</td>
      <td>f</td>
      <td>NaN</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>0.136534</td>
    </tr>
    <tr>
      <th>2</th>
      <td>280</td>
      <td>eleanor</td>
      <td>138</td>
      <td>f</td>
      <td>NaN</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>0.021583</td>
    </tr>
    <tr>
      <th>3</th>
      <td>280</td>
      <td>francesca johns</td>
      <td>2251</td>
      <td>f</td>
      <td>46.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>0.352049</td>
    </tr>
    <tr>
      <th>4</th>
      <td>280</td>
      <td>madge</td>
      <td>190</td>
      <td>f</td>
      <td>46.0</td>
      <td>tt0112579</td>
      <td>The Bridges of Madison County</td>
      <td>1995</td>
      <td>142.0</td>
      <td>0.029715</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23043</th>
      <td>9254</td>
      <td>lumiere</td>
      <td>1063</td>
      <td>m</td>
      <td>56.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>0.104636</td>
    </tr>
    <tr>
      <th>23044</th>
      <td>9254</td>
      <td>maurice</td>
      <td>1107</td>
      <td>m</td>
      <td>71.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>0.108967</td>
    </tr>
    <tr>
      <th>23045</th>
      <td>9254</td>
      <td>monsieur d'arqu</td>
      <td>114</td>
      <td>m</td>
      <td>58.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>0.011222</td>
    </tr>
    <tr>
      <th>23046</th>
      <td>9254</td>
      <td>mrs. potts</td>
      <td>564</td>
      <td>f</td>
      <td>66.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>0.055517</td>
    </tr>
    <tr>
      <th>23047</th>
      <td>9254</td>
      <td>wardrobe</td>
      <td>121</td>
      <td>f</td>
      <td>54.0</td>
      <td>tt0101414</td>
      <td>Beauty and the Beast</td>
      <td>1991</td>
      <td>452.0</td>
      <td>0.011911</td>
    </tr>
  </tbody>
</table>
<p>23048 rows × 10 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="write-to-csv-file">
<h2>Write to CSV File<a class="headerlink" href="#write-to-csv-file" title="Permalink to this headline">¶</a></h2>
<p>Finally, we’re going to output this merged and more comprehensive dataset to a CSV file by using the <code class="docutils literal notranslate"><span class="pre">.to_csv()</span></code> method. We set the <code class="docutils literal notranslate"><span class="pre">index</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">False</span></code> to remove the index column (the numbers in the left-most column).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merged_movie_character</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/Pudding/Merged-Pudding-Film-Dialogue.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./features/Data-Analysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Pandas-Basics-Part3.html" title="previous page">Pandas Basics (Part 3)</a>
    <a class='right-next' id="next-link" href="../Data-Collection/Data-Collection.html" title="next page">Data Collection</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By <a href="https://melaniewalsh.org/">Melanie Walsh</a><br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-86905362-3', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>